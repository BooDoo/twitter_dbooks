require 'open-uri'
require 'tempfile'
Dir.mktmpdir do |dir|
  Dir.chdir dir
  Tempfile.create 'urgh' do |urgh|
    open 'https://github.com/Stawberri/twitter_dbooks/archive/master.tar.gz' do |github|
      until github.eof?
        urgh.write github.read 1024
      end
    end
    urgh.close
    system "tar -xzf #{urgh.path} --strip-components=1"
  end
  system 'bundle install --deployment; bundle exec ' + File.open('Procfile') { |pf| pf.gets.match(/:/).post_match.strip! }
end
